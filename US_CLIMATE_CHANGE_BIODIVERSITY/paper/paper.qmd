---
title: "Climate Change, Biodiversity Loss"
subtitle: "A replication analysis"
author: "Julia Kim"
thanks: "Code and data are available at: [https://github.com/julia-ve-kim/US_Climate_Change_Biodiversity](https://github.com/julia-ve-kim/US_Climate_Change_Biodiversity); Minimal and Full Replication on Social Science Reproduction platform available at [https://doi.org/10.48152/ssrp-9vc2-gp37](https://doi.org/10.48152/ssrp-9vc2-gp37) and  [https://doi.org/10.48152/ssrp-qvfh-0r62](https://doi.org/10.48152/ssrp-qvfh-0r62), respectively."
date: "April 2, 2024"
date-format: long
format: 
  pdf: 
    include-in-header: 
      text: |
        \usepackage{lscape}
        \newcommand{\blandscape}{\begin{landscape}}
        \newcommand{\elandscape}{\end{landscape}}
    documentclass: article
    geometry: margin = 1.2in
    abstract: "Abstract here."
    number-sections: true
output: 
  bookdown::pdf_document2
toc: true
fig_caption: yes
nocite: '@*'
bibliography: references.bib
---

```{r setup}
#| echo: false
#| message: false
#| warning: false 
library(here) 
library(tidyverse)
library(knitr)
library(kableExtra)

# Read data
cleaned_species_data <- read_csv(here("data/analysis_data/cleaned_speciesdata.csv"))
```

# Introduction

Throughout, our investigation is conducted using the open-source statistical programming language `R` [@R], with functionalities from `tidyverse` [@tidyverse], `knitr` [@knitr], `here` [@here] and `kableExtra` [@kableExtra]. 

The 1973 Endangered Species Act (ESA) under the U.S. Fish & Wildlife Service (USFWS) empowered the federal government of the United States to protect species from extinction [@USFWS]. Simply by listing a species as endangered, the government would promptly respond by implementing protections and regulations aimed at conserving the species and its habitat [@USFWS]. Cost-benefit analysis would be practically omitted, and legal avenues would be opened for other developmental projects to be postponed or cancelled, and millions of dollars in expenditures to be incurred [@Weitzman1]. Moreover, the listed species would be eligible to receive funds for their recovery,  with the aim of reducing their endangerment to levels that would qualify their removal from the list [@Weitzman1]. The costs of this type of environmental protection are thus considerable, growing faster than any other expenditure of comparable size in the American economy [@Weitzman1]. To illustrate, the fiscal budget of 2023 for the conservation of endangered wildlife exceeded $111 million USD for just over 300 projects [@USFWS]. Understanding the factors that influence the listing of a species on the ESA list therefore deserves serious attention. 

Evolution in genetics mean it is now possible to measure the evolutionary distinctiveness of species, by determining its genetic distance to its nearest relatives [@Moore]. 

The paper proceeds as follows. 

# Data 

## Source 

The paper and data used for replication are obtained from "Noah's Arc in a Warming World: Climate Change, Biodiversity Loss, and Public Adaptation Costs in the United States" [@Moore], published in the *Journal of the Association of Environmental and Resource Economists*. Their analysis sought, in part, to explore how the probability of a species being listed under the ESA was influenced by its conservation status, utility value to humans, and species uniqueness. Our replication seeks to address the validity of these three findings and to discuss the projected increases in species listing due to climate change. 

## Methodology 

The original dataset is made publicly available by Moore et al. [-@Moore]. It composed of $n = 64,583$ observations, with each row representing a unique species and each column indicating a specific variable. As part of our reproduction, we removed variables not of interest to our analysis and clarified the names of variables to make them easier to work with. A further discussion as to the variables of actual interest, their source of data, measurement, and the methodology employed to clean them, follow.

### Endangerment of Species 

The taxon and conservation status of species were obtained from NatureServe, an authoritative source of biodiversity data throughout the United States [@NatureServe]. The database is dynamic, being continuously updated by botanists, zoologists and ecologists, with inputs from scientists at heritage and conservation programs [@NatureServe]. The assessment of species is revised on a periodic basis, for we use the most recent assessment conducted between 1985 and 2019. 

NatureServe regroups species into nine taxon or classes of living things, of which there are five vertebrates species -- amphibians, birds, fishes, mammals, reptiles -- and four non-vertebrate species -- plants, invertebrates, fungi and protists. Such a classification is determined by experts, who collect information from field surveys, taxonomic treatments and other scientific publications [@NatureServe]. Additionally, NatureServe uses a protocol tp assign a conservation status to a species on the basis of ten factors, regrouped into three categories [@Faber-Langendoen]. The most important is rarity, composing population size and extent. The other two are the anthropogenic threats to the species and the long- and short-term trends in population size or range extent [@Faber-Langendoen]. Data collected from primary literature and the field are used to assign scores for individual factors, which are then translated into one of five final conservation status ranks [@Faber-Langendoen]. Using definitions provided by NatureServe [-@NatureServe], these five rankings are explained in @tbl-ranks.

```{r}
#| label: tbl-ranks 
#| tbl-cap: "Definition of Conservation Status Ranks used by NatureServe."
#| echo: false
#| message: false
#| warning: false
#| tbl-pos: H

stmt_table <- data.frame(
  Rank = c("G1", "G2", "G3", "G4", "G5"),
  Category = c("Critically Imperiled", "Imperiled", "Vulnerable", "Apparently Secure", "Secure"),
  Definition = c("At very high risk of extinction, due to very restricted range, extreme rarity, very severe threats or other factors.", 
               "At high risk of extinction due to restricted range, few occurrences, severe threats or other factors.",
               "Rare or local, due to restricted range, few occurences, recent or widespread threats or other factors.",
               "Uncommon, but not rare, with some cause for long-term concern.", 
               "Common, widespread and abundant.")
)

stmt_table %>% 
  knitr::kable(booktabs = T, col.names = c("Rank", "Category", "Definition")) |> 
  column_spec(1, bold = T, width = "3em") |> 
  column_spec(2, bold = T, width = "10em") |> 
  column_spec(3,  width = "27em") 
```

A breakdown of the conservation status by taxon is shown in @fig-constat, which is a replication of Figure 1B in the paper by Moore et al. [-@Moore]. To improve the visualisation of the result, we have coloured each status ranking, according to the conventional colours employed by NatureServe [-@NatureServe]. Observe 60% of species have an unknown status, being almost entirely of the invertebrate (41%), plants (40%) or fungi (16%) categories. This distribution of missing data is informative, as it suggests a lack of scientific attention to these three non-vertebrate species that appear not to be highly prioritised in the ranking process [@Moore]. In terms of the data that are known, reptiles appear to have the greatest proportion of known secure species, whilst mammals have the greatest proportion of known critically imperiled species. 

```{r}
#| label: fig-constat 
#| echo: false
#| warning: false
#| message: false
#| fig-cap: "Distribution of assessed conservation status using NatureServe ranking system. Number above the bars gives the total number of species per taxon."
#| fig-pos: H
new_cleaned_species_data <- cleaned_species_data |>
  filter(status %in% c(1, 2, 3, 4, 5, "UNK")) |>
  # relabel status numbers
  mutate(status = case_when(   
    status == 1 ~ "Critically Imperiled",
    status == 2 ~ "Imperiled",
    status == 3 ~ "Vulnerable",
    status == 4 ~ "Apparently Secure",
    status == 5 ~ "Secure",
    status == "UNK" ~ "Unknown",
    TRUE ~ as.character(status)
  )) |> 
  # convert status to a factor with the desired levels 
  mutate(status = factor(status, levels = c("Critically Imperiled", "Imperiled", "Vulnerable", "Apparently Secure", "Secure", "Unknown"))) |> 
  # convert taxon to a factor with levels arranged in the same order as in Figure 1(a)
  add_count(taxon) |> # add column that counts number of occurrences of each taxon 
  group_by(taxon, status) |>  # group by unique taxon-status groups  
  # count number of occurrences of each taxon-status group, and total number of rows in each group 
  dplyr::summarise(count = n(), total = n[1]) |> 
  mutate(proportion = count/total) 

# assign colour to each status, as used by NatureServe  
# https://www.natureserve.org/conservation-status-assessment 
status_colours <- c(
  "Critically Imperiled" = "#DB0908",   # Red
  "Imperiled" = "#F17619",               # Orange
  "Vulnerable" = "#FDD131",               # Yellow
  "Apparently Secure" = "#27BBEF",        # Light blue
  "Secure" = "#194B89",                   # Blue
  "Unknown" = "grey"                    # Grey
)

# plot data 
new_cleaned_species_data |> 
  ggplot(aes(x = taxon, y = proportion, fill = status)) + 
  geom_bar(stat = "identity", position = "fill") + 
  scale_fill_manual(values = status_colours) + # apply custom colors
  theme_minimal() + 
  theme(axis.text.x = element_text(angle = 45, hjust = 1)) + # rotate x-labels 
  labs(x="Taxon", y="Proportion", fill="Status") + 
  geom_text(aes(x = taxon, y = 1.05, label = total), size=3)  # add counts for each taxon above the stacked chart
```

### Google Ngrams for Species 

An $n$-gram is defined as a sequence of $n$ words in some particular order: a 2-gram, for instance, is a two-word sequence like "*Balaena mysticetus*", whilst a 3-gram is three-word sequence like "*Lithobates areolatus circulosus*." An on-line search engine, the Google Books Ngram Viewer uses Optical Character Recognition (OCR) to provide the frequency of such $n$-grams in a corpus of over 25 million digitised books published over the course of more than 500 years [@Google]. These books are published in eight languages; in particular, the English corpus of 2019 consists over over 16 million of such books published between 1470 and 2019 [@Michel].

As argued by Moore et al. [-@Moore], the rich variety of ways in which a species may provide utility -- through cultural significance, commercial value, scientific interest, and so forth -- should likely directly influence the frequency with which the species is written about over time. This is consistent with intuition and broader literature in applied computing, with authors positing that elements most influential on a society and culture should naturally be reflected in the written word of those who are a part of that society and culture [@Knight; @Aisopos]. As a result, following the workflow of Moore et al. [-@Moore], this analysis adopts common and scientific name $n$-grams as an additional estimate of the utility value of species to humans. Potential limitations of this measure are provided in @sec-limitations.

To determine the $n$-gram frequencies for species names, Moore et al. [-@Moore] performed case-insensitive searches in Google Books' English corpus of 2019 for all common and scientific names present in the NatureServe and ESA archives between 1800 and 2016. They assigned a frequency of 0 across all years whenever a name failed to return valid data. Here, the purpose of treating common and scientific name $n$-grams separately owes to the fact that common names pose a few challenges. In particular, a species may be designated colloquially by multiple common names or may lack a common name altogether [@Cheese]. Conversely, a single common name may be used for multiple different species (e.g., a "millipede" referring to any of the 10,000 species in the anthropod class Diplopoda) or may have additional, unrelated meanings or uses (e.g., "British soldier" referring to an army serviceman of the United Kingdom or to the lichen *Cladonia cristatella*) [@Cheese]. To account for such complicating factors, common and scientific names were thus treated separately.

As described by Moore et al. [-@Moore], $n$-gram frequencies were then aggregated to the species level. More specifically, for unlisted species, common and scientific $n$-gram frequencies were taken to be their respective averages from 1950 to 2016. For listed species, they were calculated as their respective average frequencies from 1950 to 10 years *prior* to the date of the listing decision. This was done to minimise the bias to the $n$-gram values following any publicity generated by the listing decision [@Moore]. Owing to how small the raw $n$-gram frequencies were, all frequencies were then $z$-score normalised: this was accomplished by calculating the difference between each raw frequency and the corresponding $n$-gram mean and dividing the whole by the corresponding $n$-gram standard deviation. At last, to further account for the challenges posed by common names, as discussed previously, any species whose standardised common name $n$-gram had a frequency $>10$ times its corresponding standardised scientific $n$-gram frequency were discarded in the dataset [@Moore].  

A plot of the mean standardised common and scientific $n$-gram frequencies per taxon is shown in @fig-ngram_distribution. This figure shows that scientific name $n$-grams are typically correlated with their corresponding common name $n$-grams. For birds, fishes and mammals, both types of $n$-grams are well above the standardised mean, whilst for the non-vertebrates -- comprising fungi, invertebrates and plants --, both types fall below the mean. Altogether, it appears that the utility value of a species is directly reflected in the frequency with which the species is written about *both* in colloquial and scientific settings, with vertebrate species exhibiting greater utility value than non-vertebrate species. That scientific name $n$-grams are much greater in magnitude than their corresponding common name $n$-gram may be especially driven by the preferred usage of scientific names in technical literature. 

```{r}
#| label: fig-ngram_distribution
#| echo: false
#| warning: false
#| message: false
#| fig-cap: "Distribution of the mean standardised common and scientific $n$-gram frequencies per taxon."
#| fig-pos: H

# group by taxon and calculate mean ngram_common and ngram_science
taxon_means <- cleaned_species_data |> 
  group_by(taxon)|>
  summarise(mean_ngram_common = mean(ngram_common, na.rm = TRUE), 
            mean_ngram_science = mean(ngram_science, na.rm = TRUE))

# reshape the data for plotting
taxon_means_long <- pivot_longer(taxon_means, 
                                 cols = c(mean_ngram_science, mean_ngram_common),
                                 names_to = "variable", 
                                 values_to = "mean_value")

# plot the means with legend in upper right corner
ggplot(taxon_means_long, aes(x = taxon, y = mean_value, fill = variable)) +
  geom_bar(stat = "identity", position = position_dodge()) +
  labs(x = "Taxon",
       y = expression(paste("Mean standardised ", italic("n"), "-gram frequency")),
       fill = NULL) +
  scale_fill_manual(values = c("#10c66b", "#7a7bb6"), 
                    labels = c(expression(paste(italic("n"), "-gram common")),
                               expression(paste(italic("n"), "-gram science")))) + 
  theme(axis.text.x = element_text(angle = 45, hjust = 1),
        legend.position = c(0.85, 0.84), # adjust legend position 
        legend.text.align = 0, # align legend labels to the left
        legend.margin = margin(1.5, 1.5, 1.5, 1.5),
        legend.background = element_rect(fill = alpha("white", 0.7)), # adjust transparency 
        legend.text = element_text(size = 7.5),
        legend.key.size = unit(0.5, "cm"))  # reduce size of legend squares to 0.5 cm 
```


### Species uniqueness 

Species uniqueness measures how evolutionarily isolated a species is on its family (or phylogenetic) tree [@Redding]. A highly unique species is expected to have split off long ago from its nearest living relative and, hence, to have evolved measurably different genetic features and functions compared to any other member in its phylogenetic tree [@Redding]. On a phylogenetic tree will generally appear members of the species' clade, which is to say the group of species that are descendants of a common ancestor [@Moore]. To illustrate, the Siberian tiger and North American brown bear are not regarded as evolutionarily unique: each has a number of closely-related species that are highly genetically similar and in little danger of going extinct [@Weitzman2]. At the opposite extreme are the platypus and narwhal that are so evolutionarily unique as to each form a monotypic genus: they are the only genetically distinct representatives of their entire genus and are very distantly related to their nearest relatives in other genera [@Weitzman2]. Note that a genus (or, in plural, genera) simply refers to a taxonomic classification of organisms between the levels of species and family. 

Two estimates of species uniqueness are employed in this analysis. The first is the number of species within a genus, a metric originally used by Metrick and Weitzman [-@Weitzman2]. As discussed previously, a large number of species in a single genus should imply a smaller degree of species uniqueness, and vice-versa. A benefit to this measure is that, because genera were historically defined based on obvious similarities in physical traits, it may capture aspects of distinctiveness that are more visually evident to humans [@Moore]. Another benefit is that data on the number of species in genera are widely available for almost every species ($n = 55,406/64,583$) in our dataset. For our analysis, the data were obtained from two automated databases, the Integrated Taxonomic Information Service (ITIS) and the National Centre for Biotechnology Information (NCBI), using the `taxize` package in R [@taxize]. Note ITIS and NCBI provide central databases that curate taxonomic information from submissions made by taxonomy services, specialists, and researchers working on primary literature in the field [@ITIS; @NCBI]. These experts collect and analyse morphological and molecular data from thousands of species, and compare their values to references in relevant phylogenetic literature, in order to develop robust and consistent taxonomic classifications [@Smith]. Once taxonomic placement for each species is relatively certain, researchers may then approximate the number of species in each genera by counting [@Smith]. 

The second measure to describe species uniqueness is evolutionary distinctiveness (ED), which has received the most widespread use of all uniqueness measures [@Gumbs]. ED describes the species' relative contribution to the total evolutionary history of its clade [@Moore]. A more accurate proxy than genus size, ED is computed by first assigning a value to each branch in the species' phylogenetic tree, equal to the branch's length (measured in millions of years) divided by the number of species subtending it [@Isaac]. The ED of a species is then the sum of these values for all branches from which the species is descended [@Isaac]. For our analysis, ED data were obtained by published ED scores for mammals [@Gumbs], amphibians [@Isaac; @Safi; @Gumbs], birds [@Jetz; @Gumbs] and reptiles [@Gumbs], all obtained from the Evolutionary Distinctive Globally Endangered (EDGE) of Existence program [@EDGE]. To obtain ED scores, Isaac et al. [-@Isaac], Gumbs et al. [-@Gumbs], Safi et al. [-@Safi] and Jetz et al. [-@Jetz] assembled phylogenetic trees for extant mammalia, amphibians, birds or reptiles that were maximally inclusive (i.e., including all relevant species) and maximally resolved (given the available data). The authors typically built on previously established phylogenies, adding additional clades, dating the nodes with Markov processes, and combining molecular data and taxonomic constraints for data-deficient species to more comprehensively account for uncertainty. Thereafter, they estimated the species' contribution to species uniqueness using the ED algorithm described by Isaac et al. [-@Isaac]. At the time of the analysis, no data were yet available for fish, fungi, invertebrates or protists, and too few data ($n = 319/19,092$) were yet known for the plants in our study to be considered for analysis.

In @fig-evdist_dist, we plot the distribution of the logarithm of the two uniqueness measures for four taxons of interest -- amphibians, birds, mammals and reptiles -- for which data on both measures are sufficiently available. A similar frequency distribution of genus size and ED score can be found among all taxons, except for amphibians. The distribution of amphibian genus size appears to be more left-skewed than the others, suggesting the presence of more polytypic genera and less species uniqueness. Rather contradictorily, the distribution of amphibian ED scores appears to centered around higher ED values, suggesting the presence of greater species uniqueness relative to other taxon. 

```{r}
#| label: fig-evdist_dist 
#| echo: false
#| warning: false
#| message: false
#| fig-cap: "Distribution of logarithm of two species uniqueness measures, for species in taxons for which both data are available."
#| fig-pos: H

taxa_list <- c("Amphibians", "Birds", "Mammals", "Reptiles")
filtered_data <- cleaned_species_data[cleaned_species_data$taxon %in% taxa_list, ]

# Plot
p <- ggplot(filtered_data, aes(x = ngenus)) +
  geom_histogram(binwidth = 0.15, fill = "gray", color = "black") +
  facet_grid(taxon ~ ., scales = "free") +
  theme_minimal() +
  labs(x = "Log(Genus Size)", y = "Frequency") +
  scale_x_log10() + 
  theme(strip.text.y = element_text(size = 7))

p2 <- ggplot(filtered_data, aes(x = evdist)) +
  geom_histogram(binwidth = 0.1, fill = "gray", color = "black") +
  facet_grid(taxon ~ ., scales = "free") +
  theme_minimal() +
  labs(x = "Log(ED Score)", y = "Frequency") + 
  scale_x_log10() + 
  theme(strip.text.y = element_text(size = 7))

# Arranging the plots side by side
library(gridExtra)
grid.arrange(p, p2, ncol = 2)
```

To investigate this dilemma, we make a more direct comparison between these two measures in @sec-appendix, plotting ED scores against genera size for species, for which ED scores are available. Although the relationship tends in the expected direction, whereby species in larger genera tend to be less evolutionarily distinct, only a very small proportion of the variance ($R^2 = 3.6%$) in the ED variable can be explained by the genus size variable. Consistent with Moore et al. [-@Moore], this shows that genus size is a only very weak measure of the genetic distinctiveness of a species. 

### Listing of Species 

The dependent variable of interest in this analysis is the `listed` variable, set to 1 if the species was listed for protection as of August 2020 under the ESA and to 0 otherwise. An excellent overview of the process of listing a species is described by Metrick and Weitzman [-@Weitzman2]: it begins when the species is proposed by the USFWS as a "candidate" for protection. During its period of candidacy, USFWS collects data from internal and external sources to assess whether the species warrants listing. If sufficient scientific evidence exists, then the USFWS proceeds to submit a formal proposal under the Federal Register and makes requests for comments from the public. After this period of public surveying, USFWS comes a final decision, which officially determines whether the species is listed under the ESA. 

Brief summary statistics of the total number and proportion (%) of listed species per taxon is presented in @tbl-list. The four non-vertebrates categories contain either no listed species (fungi, protists) or a relatively small proportion of listed species (invertebrates, plants). Instead, listing decisions are significantly biased towards the vertebrate categories, for which the average proportion is 7.3%-- about three times as high as the highest proportion of 2.5% among the non-vertebrate categories. 

```{r}
#| label: tbl-list 
#| tbl-cap: "Summary statistics table of the number of species listed under the ESA by taxon."
#| echo: false
#| message: false
#| warning: false
#| tbl-pos: H

library(knitr)

# group by taxon and calculate the number of listed species
summary_list_table <- cleaned_species_data %>%
  group_by(taxon) %>%
  summarise(num_listed_species = sum(listed == 1, na.rm = TRUE))

# define the total numbers of species per taxon
total_species <- c(376, 960, 1528, 6366, 25487, 935, 27382, 80, 607)

# calculate the proportion of listed species
summary_list_table$proportion_listed <- round(summary_list_table$num_listed_species / total_species * 100, 1) 

# print the summary table as a kable
kable(summary_list_table, col.names = c("Taxon", "Listed", "Prop. (%)")) |> 
  column_spec(1, bold = T) 
```


# Model

We perform a logistic regression to determine the relative importance of these species characteristics in the listing decision. 


## Model set-up


### Model justification

# Results

# Discussion

## Findings 
Since listing a species is the crucial first step in its protection, Moore et al. [-@Moore] seek to gain insights into the determinants of the government's decision to list the species under the ESA. Our paper has successfully replicated three of their major findings: 

(1) The probability of listing changes with conservation status, decreasing monotonically from the most to the least endangered. 

(2) There is some evidence that the probability of listing of a species is associated with its utility value to humans. In particular, imperiled vertebrates -- including reptiles, fish, birds, amphibians, and mammals -- are much more likely to be listed than plants and invertebrates. However, listing probability appears to be significantly affected by neither scientific nor common name $n$-grams. 

(3) There is conflicting evidence as to whether the probability of listing is related to the distinctiveness of a species. Whilst species in smaller genera are more likely to be listed, there is no evidence that the species' phylogenetic diversity plays a role in the listing decision. 

## Case study 

## Ethical Implications 

## Accounting for Bias

## Limitations {#sec-limitations}

Although the ESA mandates the listing all species at risk of extinction, capacity and budgetary constraints often slow down the the listing process, leading to a backlog of species awaiting assessment [@Alexander]. In some cases, USFWS will designate a species as "warranted but precluded" to acknowledge that listing the species is necessary but of lesser priority than other species in need of greater protection [@Alexander]. 

A limitation of the $n$-gram measure is that it captures only English-language media and includes only material published in books, excluding popular media such as amagazines, websites or newspapers. 

Limitations to using ngram as a proxy for species value 


## Future Research 
In addition, USFWS assigns a "conflict code", indicating whether or not the USFWS has determined that protection of species conflicts with economic development. 

# Appendix {#sec-appendix}

# Additional data details



# References

